create schema estudo_caso1_CC1N;
use estudo_caso1_CC1N;

# TABELAS SEM CHAVES ESTRANGEIRAS
CREATE TABLE IF NOT EXISTS FORNECEDORES(
    FORNEC_COD INT PRIMARY KEY,
    FORNEC_NOME VARCHAR(45) NOT NULL,
    FORNEC_RUA VARCHAR(45) NOT NULL,
    FORNEC_NUMRUA INT,
    FORNEC_BAIRRO VARCHAR(45) NOT NULL,
    FORNEC_ESTADO VARCHAR(45) NOT NULL,
    FORNEC_PAIS VARCHAR(30) NOT NULL,
    FORNEC_CODPOSTAL VARCHAR(10) NOT NULL,
    FORNEC_TELEFONE VARCHAR(15) NOT NULL,
    FORNEC_CONTATO TEXT NOT NULL);

CREATE TABLE IF NOT EXISTS FILIAIS(
    FILIAL_COD INT PRIMARY KEY,
    FILIAL_NOME VARCHAR(45) NOT NULL,
    FILIAL_RUA VARCHAR(100) NOT NULL,
    FILIAL_NUMRUA INT,
    FILIAL_MUNICIPIO VARCHAR(50) NOT NULL,
    FILIAL_BAIRRO VARCHAR(50) NOT NULL,
    FILIAL_CIDADE VARCHAR(50) NOT NULL,
    FILIAL_ESTADO VARCHAR(50) NOT NULL,
    FILIAL_PAIS VARCHAR(50) NOT NULL,
    FILIAL_CODPOSTAL VARCHAR(10) NOT NULL,
    FILIAL_CAPACIDADE TEXT NOT NULL);

CREATE TABLE IF NOT EXISTS PRODUTOS(
    PROD_COD INT PRIMARY KEY,
    PROD_NOME VARCHAR(50) NOT NULL,
    PROD_DESCRICAO TEXT NOT NULL,
    PROD_ESPECTEC TEXT NOT NULL,
    PROD_QUANT DECIMAL(10,3) NOT NULL,
    PROD_PRECOUNIT DECIMAL(10,2) NOT NULL,
    PROD_UNIDMEDIDA VARCHAR(10) NOT NULL,
    PROD_ESTOQ_MIN DECIMAL(10,3) NOT NULL);

# TABELAS COM CHAVES ESTRANGEIRAS
CREATE TABLE IF NOT EXISTS PEDIDOS(
    PED_CODIGO INT PRIMARY KEY,
    PED_DATA DATE NOT NULL,
    PED_HORA TIME NOT NULL,
    PED_PREVISAO DATE NOT NULL,
    PED_STATUS ENUM('PENDENTE', 'CONCLUÍDO', 'EM ESPERA') NOT NULL,
    PED_FORNECEDOR INT NOT NULL,
    CONSTRAINT FK_FORNECEDOR FOREIGN KEY (PED_FORNECEDOR) REFERENCES FORNECEDORES(FORNEC_COD));

CREATE TABLE IF NOT EXISTS RECEBIMENTOS(
    RECEB_DATA DATE NOT NULL,
    RECEB_HORA TIME NOT NULL,
    RECEB_QUANT_PROD DECIMAL(10,3),
    RECEB_CONDICAO TEXT NOT NULL,
    RECEB_PEDIDOS INT PRIMARY KEY,
    CONSTRAINT FK_PEDIDOS FOREIGN KEY (RECEB_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO));

# ENTIDADES ASSOCIATIVAS
CREATE TABLE IF NOT EXISTS PEDIDOS_PRODUTOS(
    PDPR_PEDIDOS INT,
    PDPR_PRODUTOS INT,
    PRIMARY KEY (PDPR_PEDIDOS, PDPR_PRODUTOS),
    PDPR_QUANT DECIMAL(10,3) NOT NULL,
    CONSTRAINT PDPR_FK_PEDIDOS FOREIGN KEY (PDPR_PEDIDOS) REFERENCES PEDIDOS(PED_CODIGO),
    CONSTRAINT PDPR_FK_PRODUTOS FOREIGN KEY (PDPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD));

CREATE TABLE IF NOT EXISTS FILIAIS_PRODUTOS(
    FLPR_FILIAL INT,
    FLPR_PRODUTOS INT,
    FLPR_QUANT DECIMAL(10,3) NOT NULL,
    PRIMARY KEY (FLPR_FILIAL, FLPR_PRODUTOS),
    CONSTRAINT FLPR_FK_FILIAIS FOREIGN KEY (FLPR_FILIAL) REFERENCES FILIAIS(FILIAL_COD),
    CONSTRAINT FLPR_FK_PRODUTOS FOREIGN KEY (FLPR_PRODUTOS) REFERENCES PRODUTOS(PROD_COD));

CREATE TABLE IF NOT EXISTS FORNECEDORES_PRODUTOS(
FRPR_FORNECEDOR INT,
FRPR_PRODUTOS INT,
PRIMARY KEY(FRPR_FORNECEDOR,FRPR_PRODUTOS),
CONSTRAINT FRPR_FK_FORNECEDORES FOREIGN KEY(FRPR_FORNECEDOR)
REFERENCES FORNECEDORES(FORNEC_COD),
CONSTRAINT FRPR_FK_PRODUTOS FOREIGN KEY(FRPR_PRODUTOS) 
REFERENCES PRODUTOS(PROD_COD));

INSERT INTO FORNECEDORES VALUES (1, 'Fornecedor A', 'Rua A', 100, 'Bairro A', 'ES', 'Brasil', '12345-678', '(27) 3333-3333', 'Contato A');
INSERT INTO FORNECEDORES VALUES (2, 'Fornecedor B', 'Rua B', 200, 'Bairro B', 'RJ', 'Brasil', '23456-789', '(21) 4444-4444', 'Contato B');
INSERT INTO FORNECEDORES VALUES (3, 'Fornecedor C', 'Rua C', 300, 'Bairro C', 'SP', 'Brasil', '34567-890', '(11) 5555-5555', 'Contato C');
INSERT INTO FORNECEDORES VALUES (4, 'Fornecedor D', 'Rua D', 400, 'Bairro D', 'MG', 'Brasil', '45678-901', '(31) 6666-6666', 'Contato D');
INSERT INTO FORNECEDORES VALUES (5, 'Fornecedor E', 'Rua E', 500, 'Bairro E', 'PR', 'Brasil', '56789-012', '(41) 7777-7777', 'Contato E');

INSERT INTO FILIAIS VALUES (1, 'Filial A', 'Rua X', 101, 'Município A', 'Bairro X', 'Cidade X', 'ES', 'Brasil', '11111-111', 'Alta');
INSERT INTO FILIAIS VALUES (2, 'Filial B', 'Rua Y', 102, 'Município B', 'Bairro Y', 'Cidade Y', 'RJ', 'Brasil', '22222-222', 'Média');
INSERT INTO FILIAIS VALUES (3, 'Filial C', 'Rua Z', 103, 'Município C', 'Bairro Z', 'Cidade Z', 'SP', 'Brasil', '33333-333', 'Baixa');
INSERT INTO FILIAIS VALUES (4, 'Filial D', 'Rua W', 104, 'Município D', 'Bairro W', 'Cidade W', 'MG', 'Brasil', '44444-444', 'Alta');
INSERT INTO FILIAIS VALUES (5, 'Filial E', 'Rua V', 105, 'Município E', 'Bairro V', 'Cidade V', 'PR', 'Brasil', '55555-555', 'Média');

INSERT INTO PRODUTOS VALUES (1, 'Produto A', 'Descrição A', 'Especificação A', 100.000, 10.50, 'Unidade', 10.000);
INSERT INTO PRODUTOS VALUES (2, 'Produto B', 'Descrição B', 'Especificação B', 200.000, 20.00, 'Unidade', 20.000);
INSERT INTO PRODUTOS VALUES (3, 'Produto C', 'Descrição C', 'Especificação C', 150.000, 15.75, 'Unidade', 15.000);
INSERT INTO PRODUTOS VALUES (4, 'Produto D', 'Descrição D', 'Especificação D', 300.000, 30.50, 'Unidade', 30.000);
INSERT INTO PRODUTOS VALUES (5, 'Produto E', 'Descrição E', 'Especificação E', 250.000, 25.25, 'Unidade', 25.000);

INSERT INTO PEDIDOS VALUES (1, '2024-10-01', '10:00:00', '2024-10-15', 'PENDENTE', 1);
INSERT INTO PEDIDOS VALUES (2, '2024-10-02', '11:00:00', '2024-10-16', 'CONCLUÍDO', 2);
INSERT INTO PEDIDOS VALUES (3, '2024-10-03', '12:00:00', '2024-10-17', 'EM ESPERA', 3);
INSERT INTO PEDIDOS VALUES (4, '2024-10-04', '13:00:00', '2024-10-18', 'PENDENTE', 4);
INSERT INTO PEDIDOS VALUES (5, '2024-10-05', '14:00:00', '2024-10-19', 'CONCLUÍDO', 5);

INSERT INTO RECEBIMENTOS VALUES ('2024-10-01', '15:00:00', 50.000, 'Boa', 1);
INSERT INTO RECEBIMENTOS VALUES ('2024-10-02', '16:00:00', 75.000, 'Ótima', 2);
INSERT INTO RECEBIMENTOS VALUES ('2024-10-03', '17:00:00', 100.000, 'Regular', 3);
INSERT INTO RECEBIMENTOS VALUES ('2024-10-04', '18:00:00', 150.000, 'Excelente', 4);
INSERT INTO RECEBIMENTOS VALUES ('2024-10-05', '19:00:00', 200.000, 'Boa', 5);

INSERT INTO PEDIDOS_PRODUTOS VALUES (1, 1, 10.000);
INSERT INTO PEDIDOS_PRODUTOS VALUES (1, 2, 20.000);
INSERT INTO PEDIDOS_PRODUTOS VALUES (2, 3, 30.000);
INSERT INTO PEDIDOS_PRODUTOS VALUES (2, 4, 40.000);
INSERT INTO PEDIDOS_PRODUTOS VALUES (3, 5, 50.000);

INSERT INTO FILIAIS_PRODUTOS VALUES (1, 1, 60.000);
INSERT INTO FILIAIS_PRODUTOS VALUES (1, 2, 70.000);
INSERT INTO FILIAIS_PRODUTOS VALUES (2, 3, 80.000);
INSERT INTO FILIAIS_PRODUTOS VALUES (2, 4, 90.000);
INSERT INTO FILIAIS_PRODUTOS VALUES (3, 5, 100.000);

INSERT INTO FORNECEDORES_PRODUTOS VALUES (1, 1);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (2, 2);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (3, 3);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (4, 4);
INSERT INTO FORNECEDORES_PRODUTOS VALUES (5, 5);

UPDATE FORNECEDORES SET FORNEC_NOME = 'Fornecedor X' WHERE FORNEC_COD = 1;
UPDATE FORNECEDORES SET FORNEC_TELEFONE = '(27) 8888-8888' WHERE FORNEC_COD = 2;

UPDATE FILIAIS SET FILIAL_NOME = 'Filial X' WHERE FILIAL_COD = 1;
UPDATE FILIAIS SET FILIAL_CAPACIDADE = 'Muito Alta' WHERE FILIAL_COD = 2;

UPDATE PRODUTOS SET PROD_PRECOUNIT = 11.00 WHERE PROD_COD = 1;
UPDATE PRODUTOS SET PROD_QUANT = 120.000 WHERE PROD_COD = 2;

UPDATE PEDIDOS SET PED_STATUS = 'CONCLUÍDO' WHERE PED_CODIGO = 1;
UPDATE PEDIDOS SET PED_PREVISAO = '2024-10-20' WHERE PED_CODIGO = 2;

UPDATE RECEBIMENTOS SET RECEB_QUANT_PROD = 60.000 WHERE RECEB_PEDIDOS = 1;
UPDATE RECEBIMENTOS SET RECEB_CONDICAO = 'Muito Boa' WHERE RECEB_PEDIDOS = 2;

UPDATE PEDIDOS_PRODUTOS SET PDPR_QUANT = 15.000 WHERE PDPR_PEDIDOS = 1 AND PDPR_PRODUTOS = 1;
UPDATE PEDIDOS_PRODUTOS SET PDPR_QUANT = 25.000 WHERE PDPR_PEDIDOS = 1 AND PDPR_PRODUTOS = 2;

UPDATE FILIAIS_PRODUTOS SET FLPR_QUANT = 65.000 WHERE FLPR_FILIAL = 1 AND FLPR_PRODUTOS = 1;
UPDATE FILIAIS_PRODUTOS SET FLPR_QUANT = 75.000 WHERE FLPR_FILIAL = 1 AND FLPR_PRODUTOS = 2;

UPDATE FORNECEDORES_PRODUTOS SET FRPR_FORNECEDOR = 2 WHERE FRPR_FORNECEDOR = 1 AND FRPR_PRODUTOS = 1;
UPDATE FORNECEDORES_PRODUTOS SET FRPR_PRODUTOS = 2 WHERE FRPR_FORNECEDOR = 2 AND FRPR_PRODUTOS = 2;

DELETE FROM PEDIDOS_PRODUTOS WHERE PDPR_PEDIDOS = 5 AND PDPR_PRODUTOS = 5;
